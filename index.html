<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tap Trials - Monster Edition</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b0f1f;
  --panel:rgba(255,255,255,0.08);
  --accent:#4ade80;
  --accent2:#60a5fa;
  --text:#e5e7eb;
}
*{box-sizing:border-box;font-family:'Poppins',system-ui,sans-serif;}
body{margin:0;background:radial-gradient(circle at top,#12183a,#05070f);color:var(--text);text-align:center;}
#loading{position:fixed;inset:0;background:#05070f;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:9999;animation:fadeOut 1s ease forwards;animation-delay:4s;}
#loading h1{font-size:42px;animation:pulse 2s infinite;}
@keyframes pulse{0%{transform:scale(1)}100%{transform:scale(1.05)}}
@keyframes fadeOut{to{opacity:0;pointer-events:none;}}
.container{max-width:480px;margin:auto;padding:16px;}
.panel{background:linear-gradient(180deg,var(--panel),transparent);border-radius:20px;padding:16px;margin-bottom:16px;box-shadow:0 12px 30px rgba(0,0,0,.4);}
#clicks{font-size:36px;font-weight:800;margin:10px 0;}
#tap{width:100%;padding:26px;font-size:26px;font-weight:800;border:none;border-radius:22px;background:linear-gradient(135deg,var(--accent),#22c55e);color:#06210f;cursor:pointer;transition:.08s;}
#tap:active{transform:scale(.95);}
.stats{display:flex;justify-content:space-between;opacity:.8;}
.tabs button{width:30%;margin:5px 1%;padding:10px;border:none;border-radius:14px;background:var(--accent2);color:#081226;font-weight:600;}
.hidden{display:none;}
.upgrade{display:flex;justify-content:space-between;align-items:center;margin:10px 0;padding:12px;border-radius:14px;background:rgba(255,255,255,.06);}
.upgrade button{background:var(--accent);border:none;border-radius:12px;padding:8px 14px;font-weight:600;}
.particle{position:absolute;pointer-events:none;font-weight:700;color:var(--accent);animation:floatUp .8s forwards;}
@keyframes floatUp{from{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-60px)}}
#energyContainer{width:100%;height:20px;background:rgba(255,255,255,.1);border-radius:10px;margin:10px 0;overflow:hidden;}
#energy-bar{height:100%;width:100%;background:var(--accent);transition:width 0.05s linear;}
#tab-click,#tab-auto{max-height:300px;overflow-y:auto;}
#prestige-container{margin-top:10px;}
#prestige-button{padding:10px 20px;border:none;border-radius:12px;background:#facc15;color:#081226;font-weight:700;cursor:pointer;}
</style>
</head>
<body>
<div id="loading"><h1>Tap Trials</h1></div>
<div class="container">
<div class="panel">
<h1>Tap Trials</h1>
<div id="clicks">0</div>
<button id="tap">TAP</button>
<div id="energyContainer"><div id="energy-bar"></div></div>
<div class="stats">
<div>Power: <b id="power">1</b></div>
<div>CPS: <b id="cps">0</b></div>
<div>Prestige: <b id="prestige">0</b>x</div>
</div>
<div id="prestige-container">
<button id="prestige-button">Prestige Reset</button>
</div>
</div>

<div class="panel tabs">
<button onclick="showTab('click')">Click</button>
<button onclick="showTab('auto')">Auto</button>
</div>

<div class="panel" id="tab-click"></div>
<div class="panel hidden" id="tab-auto"></div>
</div>

<script>
// ======= Data & Save System =======
let data = JSON.parse(localStorage.getItem("tapTrialsSave")) || {
clicks:0, power:1, cps:0, prestige:0, lastActive:Date.now()
};

// ======= Utility Functions =======
function fmt(n){
  if(n<1e3) return Math.floor(n);
  const s=["K","M","B","T","Qa","Qi"];
  let i=Math.floor(Math.log10(n)/3);
  return (n/Math.pow(1e3,i)).toFixed(2).replace(".00","")+s[i-1];
}

function particle(x,y,text){
  const p=document.createElement("div");
  p.className="particle";
  p.textContent=text;
  p.style.left=(x+Math.random()*10-5)+"px";
  p.style.top=(y+Math.random()*10-5)+"px";
  document.body.appendChild(p);
  setTimeout(()=>p.remove(),800);
}

// ======= Energy System =======
let energy = 100;
const maxEnergy = 100;
const energyDrainPerTap = 10;
const drainSpeed = 1;

function drainEnergy(amount){
  const target = Math.max(energy-amount,0);
  function step(){
    if(energy>target){
      energy-=drainSpeed;
      if(energy<target) energy=target;
      updateEnergyUI();
      requestAnimationFrame(step);
    }
  }
  step();
}

function regenEnergy(){
  if(energy<maxEnergy){energy+=0.2;if(energy>maxEnergy) energy=maxEnergy;updateEnergyUI();}
  requestAnimationFrame(regenEnergy);
}
regenEnergy();

function updateEnergyUI(){
  document.getElementById("energy-bar").style.width = `${(energy/maxEnergy)*100}%`;
}

// ======= Dynamic Upgrade System =======
const clickUpgrades = [];
const autoUpgrades = [];
for(let i=1;i<=300;i++){
  clickUpgrades.push({name:`Click +${i}`, cost: Math.floor(10*Math.pow(1.15,i)), add:i, type:'click'});
  autoUpgrades.push({name:`Auto +${i}`, cost: Math.floor(50*Math.pow(1.2,i)), add:i, type:'auto'});
}

function renderUpgrades(type){
  const container = document.getElementById(`tab-${type}`);
  container.innerHTML = `<h2>${type==='click'?'Click':'Auto'} Upgrades</h2>`;
  const upgrades = type==='click'?clickUpgrades:autoUpgrades;
  upgrades.forEach(u=>{
    const div = document.createElement("div");
    div.className = "upgrade";
    div.innerHTML = `${u.name}<button ${data.clicks<u.cost?"disabled":""}>${fmt(u.cost)}</button>`;
    div.querySelector("button").onclick = ()=>{
      if(data.clicks>=u.cost){
        data.clicks-=u.cost;
        if(u.type==='click') data.power += u.add*(1+data.prestige*0.05);
        else data.cps += u.add*(1+data.prestige*0.05);
        u.cost = Math.floor(u.cost*1.8);
        update();
      }
    };
    container.appendChild(div);
  });
}

// ======= Tap Handler =======
const tap=document.getElementById("tap");
tap.addEventListener("pointerdown",e=>{
  if(energy>0){
    data.clicks += data.power*(1+data.prestige*0.05);
    particle(e.clientX,e.clientY,"+"+fmt(Math.floor(data.power*(1+data.prestige*0.05))));
    drainEnergy(energyDrainPerTap);
    update();
  }
});

// ======= Prestige =======
const prestigeBtn = document.getElementById("prestige-button");
prestigeBtn.addEventListener("click",()=>{
  if(confirm("Are you sure you want to Prestige? This resets clicks, power, CPS but gives permanent bonus.")){
    data.prestige += 1;
    data.clicks = 0;
    data.power = 1;
    data.cps = 0;
    // Optionally reset upgrade costs
    clickUpgrades.forEach(u=>{ u.cost = Math.floor(10*Math.pow(1.15,parseInt(u.name.split('+')[1]))); });
    autoUpgrades.forEach(u=>{ u.cost = Math.floor(50*Math.pow(1.2,parseInt(u.name.split('+')[1]))); });
    update();
  }
});

// ======= Offline Earnings =======
const now = Date.now();
const elapsed = Math.floor((now - data.lastActive)/1000); // in seconds
data.clicks += elapsed*data.cps;
data.lastActive = now;

// ======= Rendering & Update =======
function update(){
  document.getElementById("clicks").textContent = fmt(Math.floor(data.clicks));
  document.getElementById("power").textContent = fmt(Math.floor(data.power));
  document.getElementById("cps").textContent = fmt(Math.floor(data.cps));
  document.getElementById("prestige").textContent = data.prestige;
  data.lastActive = Date.now();
  localStorage.setItem("tapTrialsSave",JSON.stringify(data));
  renderUpgrades("click");
  renderUpgrades("auto");
}

function showTab(t){
  document.getElementById("tab-click").classList.add("hidden");
  document.getElementById("tab-auto").classList.add("hidden");
  document.getElementById("tab-"+t).classList.remove("hidden");
}

// ======= Auto CPS Interval =======
setInterval(()=>{
  if(energy>0){data.clicks += data.cps; update();}
},1000);

update();
</script>
</body>
</html>
